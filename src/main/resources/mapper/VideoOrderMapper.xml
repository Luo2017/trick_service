<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.trick.trick_class.mapper.VideoOrderMapper">

    <select id="findByUserIdAndVideoIdAndState" resultType="VideoOrder">

        select * from video_order where user_id = #{user_id} and video_id = #{video_id} and state = #{state}

    </select>

    <!--mysql提供了拷贝功能，可以直接右键选拷贝insert statement即可-->
    <!--不用写插入类型，会自动识别，下面可以使得数据库自动生成的主键赋予原对象的id-->
    <insert id="saveOrder" useGeneratedKeys="true" keyColumn="id" keyProperty="id">

        INSERT INTO video_order
        (
        `out_trade_no`,
        `state`,
        `create_time`,
        `total_fee`,
        `video_id`,
        `video_title`,
        `video_img`,
        `user_id`)
        VALUES
        (
        #{outTradeNo, jdbcType=VARCHAR},
        #{state, jdbcType=INTEGER},
        #{createTime, jdbcType=TIMESTAMP},
        #{totalFee, jdbcType=INTEGER},
        #{videoId, jdbcType=INTEGER},
        #{videoTitle, jdbcType=VARCHAR},
        #{videoImg, jdbcType=VARCHAR},
        #{userId, jdbcType=INTEGER}
        )

    </insert>

    <select id="listOrderByUserId" resultType="videoOrder">
        select * from video_order where user_id=#{user_id} order by create_time desc
    </select>

</mapper>